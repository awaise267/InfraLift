<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- Free web templates by http://www.templatesdock.com; released for free under a Creative Commons Attribution 3.0 License -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="content-language" content="en" />
	<meta name="description" content="[HERE PASTE YOUR DESCRIPTION]" />
	<meta name="author" content="Template:TemplatesDock [www.templatesdock.com]; e-mail:hello@templatesdock.com" />
	<link rel="stylesheet" media="screen,projection" type="text/css" href="css/AnalyticsMain.css" />
	<link rel="stylesheet" media="screen,projection" type="text/css" href="css/skin.css" />
	<link rel="stylesheet" media="screen,projection" type="text/css" href="css/addcontact.css" /><!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" href="css/comments_style.css">
	<script type="text/javascript" src="javascript/jquery.js"></script>	
	<script type="text/javascript" src="javascript/jquery.loopedslider.js"></script>	
	<script type="text/javascript" src="javascript/cufon-yui.js"></script>
	<script type="text/javascript" src="javascript/font.font.js"></script>
	<script type="text/javascript">Cufon.replace('.cufon, .nav, .slogan', {hover:true});</script>
	
    <script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
    <script type="text/javascript" src="/controllers/userposts.js"></script>    		
	<!--[if IE 6]><script src="javascript/pngfix.js"></script><script>DD_belatedPNG.fix('.logo img, .nav a, .section');</script><![endif]--> 	
	<title>InfraLift</title>
	
	
</head>

<body>

<div class="bg">

<div class="main">

	<!-- HEADER -->
	<div class="header box custom">

		<p class="logo" style="top:0px;"><a href="/"><img src="design/TransparentLogo2.png" style="width:250px;height:160px;" alt="" /></a></p>
		
		<!-- NAVIGATION -->
		<ul class="nav box">
			<li class="current"><a href="/">Home</a></li>
			<li><a href="/addcontacts">Add Contacts</a></li>
			<li><a href="/viewcontacts">View Contacts</a></li>
			<li><a href="/analytics">View Analytics</a></li>
			<li><a href="/logout">Logout</a></li>
		</ul>

	</div> <!-- /header -->
	
	<!-- SLOGAN -->
	<div class="slogan custom">
		<br><br>
		<h2>Distribution of reported issues</h2>
		
	</div> <!-- /slogan -->

	<!-- SECTION -->
	<div class="section box" style="margin-top:0px; box-shadow: 2px 5px 5px #888888;">

		
		<!-- CONTENT -->
		<div class="content box container" >
			<hr class="style-one"><br/>
			<!-- HEADINGS -->
		<div class="row">	
			<!-- Repeat -->
			<div class="col-md-6">
			<div class="box" style="box-shadow: 10px 10px 5px #888888;">
				<div class="container" style="width:48% !important;">
					<h3> Geographic Distribution </h3>
					<!--Image-->
					<div class="row" id="map" style="min-height:400px; min-width:600px; padding:0; postition:relative; top:0 !important; left:-150px; !important;">
						
					</div>
					<!--Image-->
					
					
					
				</div>
			</div>
			</div>
			
			<div class="col-md-6">
			<div class="box" style="box-shadow: 10px 10px 5px #888888; ">
				<div class="container" style="width:48% !important;">
					<h3> Zipcode Wise Distribution </h3>
					<!--Image-->
					<div class="row" id="visualization" style="min-height:400px;">
						
					</div>
					<!--Image-->
					
					
					
				</div>
			</div>
			</d	iv>
		</div>
			<br><br>			
			<!-- Repeat -->
			
			
		
			
	   
		</div> <!-- /content -->

		<br/><br/>
		<br/><br/>

	<!-- HEADINGS -->
		<div class="row">	
			<!-- Repeat -->
			<div class="col-md-6">
			<div class="box" style="box-shadow: 10px 10px 5px #888888; ">
				<div class="container" style="width:48% !important;">
					
					<!--Image-->
					<div class="row" id="chart_div" style="min-height:400px;">
						
					</div>
					<!--Image-->
					
					<h3> Day Wise Chart </h3>
					
				</div>
			</div>
			</div>
			
			<div class="col-md-6">
			<div class="box" style="box-shadow: 10px 10px 5px #888888; ">
				<div class="container" style="width:48% !important;">
					
					<!--Image-->
					<div class="row" id="chart_div2" style="min-height:400px;">
						
					</div>
					<!--Image-->
					
					<h3> State Wise Chart </h3>
					
				</div>
			</div>
			</div>
		</div>
			<br><br>			
			<!-- Repeat -->
			
			
		
			
	   
		</div> <!-- /content -->


		</div> <!-- /section -->		

	<!-- FOOTER -->
	<div class="footer box">

		<p class="f-right t-right">
			InfraLift Inc.<br />
			<a href="#">www.InfraLift.com</a><br />
			<a href="#">InfraLift@gmail.com</a><br />
			Address: San Jose<br />
			Phone: (###) ###-####
		</p>
	
		<p class="f-left">
			Copyright &copy;&nbsp;2015 <a href="/">InfraLift Inc</a><br />
		</p>

	</div> <!-- /footer -->

</div> <!-- /main -->

</div> <!-- /bg -->


<!-- Maps -->


<script type="text/javascript">
  var delay = 100;
  var infowindow = new google.maps.InfoWindow();
  var latlng = new google.maps.LatLng(37.334558,  -121.893225);
  var mapOptions = {
    zoom: 5,
    center: latlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var geocoder = new google.maps.Geocoder(); 
  var map = new google.maps.Map(document.getElementById("map"), mapOptions);
  var bounds = new google.maps.LatLngBounds();

  function geocodeAddress(address, next) {
    geocoder.geocode({address:address}, function (results,status)
      { 
         if (status == google.maps.GeocoderStatus.OK) {
          var p = results[0].geometry.location;
          var lat=p.lat();
          var lng=p.lng();
          createMarker(address,lat,lng);
        }
        else {
           if (status == google.maps.GeocoderStatus.OVER_QUERY_LIMIT) {
            nextAddress--;
            delay++;
          } else {}   
        }
        next();
      }
    );
  }
 function createMarker(add,lat,lng) {
      var contentString = add;
	  var marker = new google.maps.Marker({
	   		position: new google.maps.LatLng(lat,lng),
    		map: map,
	  });

	  google.maps.event.addListener(marker, 'click', function() {
	     infowindow.setContent(contentString); 
	     infowindow.open(map,marker);
	   });

 		bounds.extend(marker.position);

 }
  var locations = [
  <% for(var i in data) 
	            {                     
            %>
	                               '<%=data[i].ADDRESS%>',
	       <% 
	            }  
	       %>
	                      ];
  var nextAddress = 0;
  function theNext() {
    if (nextAddress < locations.length) {
      setTimeout('geocodeAddress("'+locations[nextAddress]+'",theNext)', delay);
      nextAddress++;
    } else {
      map.fitBounds(bounds);
    }
  }
  theNext();

</script>

<!-- Maps -->



<!-- Charts -->


<script type="text/javascript">
        
            //load package

            function drawVisualization() {
                // Create and populate the data table.
                var data = google.visualization.arrayToDataTable([
                    [{label: 'Zip', type: 'string'},
		           {label: 'Structures', type: 'number'}],
		           <% for(var i in resdata) 
			            {                     
		            %>
		           ['<%=resdata[i].ZIPCODE%>', <%=resdata[i].Count%>],
		           <% 
			            }  
			       %>
		        ]);
        
        
        var data3 = google.visualization.arrayToDataTable([
        ['Date', 'No. of Requests'],
        <% for(var i in resdata2) 
	            {                     
            %>
        ["<%=resdata2[i].DATE_UPLOADED%>",<%=resdata2[i].DATECount%>],
        <% 
	            }  
	       %>
      ]);

      var options = {
        chart: {
          title: 'Daywise Requests'
        },
        hAxis: {
          title: 'Day-wise Requests',
          minValue: 0,
        },
        vAxis: {
          title: 'Date'
        },
        bars: 'horizontal',
        axes: {
          y: {
            0: {side: 'right'}
          }
        }
      };
      
      
      
      var data2 = google.visualization.arrayToDataTable([
        ['Date', 'No. of Requests'],
        <% for(var i in resdata3) 
	            {                     
            %>
        ["<%=resdata3[i].STATE%>",<%=resdata3[i].StateCount%>],
        <% 
	            }  
	       %>
      ]);

      var options2 = {
        chart: {
          title: 'State wise Requests'
        },
        hAxis: {
          title: 'State-wise Requests',
          minValue: 0,
        },
        vAxis: {
          title: 'Date'
        },
        bars: 'horizontal',
        axes: {
          y: {
            0: {side: 'right'}
          }
        }
        };   
 
                // Create and draw the visualization.
                new google.visualization.PieChart(document.getElementById('visualization')).draw(data, {title:"Zip Code wise classificaton of requests"});
                
      			
      			
                  
                  
                  var chart1 = new google.charts.Bar(document.getElementById('chart_div'));
					google.visualization.events.addOneTimeListener(chart1, 'ready', function(){
     					new google.charts.Bar(document.getElementById('chart_div2')).draw(data2, options2);   
					});
				chart1.draw(data3, options); 
      
    }
    google.setOnLoadCallback(function(){
    	drawVisualization();
    });
    google.load('visualization', '1', {packages: ['corechart', 'bar']});
</script>


<!-- Charts -->








<script type="text/javascript"> Cufon.now(); </script>

</body>
</html>
